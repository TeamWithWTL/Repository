/**
 * 设置每月签到次数
 */

var basePath = $("#basePath").val();
//验证
$(document).ready(function(){
	$('#addForm').bootstrapValidator({
	    feedbackIcons: {
	        valid: 'glyphicon glyphicon-ok',
	        invalid: 'glyphicon glyphicon-remove',
	        validating: 'glyphicon glyphicon-refresh'
	    },
	    submitButtons: '#saveBtn',
	    fields: {
	    	oneMonth: {
	            validators: {
	                notEmpty: {
	                    message: '应到次数不能为空'
	                },
	                regexp: {
                        regexp: /^[1-9]\d*$/,
                        message: '应到次数必须大于0的整数'
                    }
	            }
	        },
	        twoMonth: {
	            validators: {
	                notEmpty: {
	                    message: '应到次数不能为空'
	                },
	                regexp: {
                        regexp: /^[1-9]\d*$/,
                        message: '应到次数必须大于0的整数'
                    }
	            }
	        },
	        threeMonth: {
	            validators: {
	                notEmpty: {
	                    message: '应到次数不能为空'
	                },
	                regexp: {
                        regexp: /^[1-9]\d*$/,
                        message: '应到次数必须大于0的整数'
                    }
	            }
	        },
	        fourMonth: {
	            validators: {
	                notEmpty: {
	                    message: '应到次数不能为空'
	                },
	                regexp: {
                        regexp: /^[1-9]\d*$/,
                        message: '应到次数必须大于0的整数'
                    }
	            }
	        },
	        fiveMonth: {
	            validators: {
	                notEmpty: {
	                    message: '应到次数不能为空'
	                },
	                regexp: {
                        regexp: /^[1-9]\d*$/,
                        message: '应到次数必须大于0的整数'
                    }
	            }
	        },
	        sixMonth: {
	            validators: {
	                notEmpty: {
	                    message: '应到次数不能为空'
	                },
	                regexp: {
                        regexp: /^[1-9]\d*$/,
                        message: '应到次数必须大于0的整数'
                    }
	            }
	        },
	        sevenMonth: {
	            validators: {
	                notEmpty: {
	                    message: '应到次数不能为空'
	                },
	                regexp: {
                        regexp: /^[1-9]\d*$/,
                        message: '应到次数必须大于0的整数'
                    }
	            }
	        },
	        eightMonth: {
	            validators: {
	                notEmpty: {
	                    message: '应到次数不能为空'
	                },
	                regexp: {
                        regexp: /^[1-9]\d*$/,
                        message: '应到次数必须大于0的整数'
                    }
	            }
	        },
	        nineMonth: {
	            validators: {
	                notEmpty: {
	                    message: '应到次数不能为空'
	                },
	                regexp: {
                        regexp: /^[1-9]\d*$/,
                        message: '应到次数必须大于0的整数'
                    }
	            }
	        },
	        tenMonth: {
	            validators: {
	                notEmpty: {
	                    message: '应到次数不能为空'
	                },
	                regexp: {
                        regexp: /^[1-9]\d*$/,
                        message: '应到次数必须大于0的整数'
                    }
	            }
	        },
	        elevenMonth: {
	            validators: {
	                notEmpty: {
	                    message: '应到次数不能为空'
	                },
	                regexp: {
                        regexp: /^[1-9]\d*$/,
                        message: '应到次数必须大于0的整数'
                    }
	            }
	        },twelveMonth: {
	            validators: {
	                notEmpty: {
	                    message: '应到次数不能为空'
	                },
	                regexp: {
                        regexp: /^[1-9]\d*$/,
                        message: '应到次数必须大于0的整数'
                    }
	            }
	        }
	    }
	});
});

/**
 * 保存每月签到次数
 */
function subMyForm(){
	if(null == $("#oneMonth").val() || "" == $("#oneMonth").val()){
		top.layer.msg('一月签到次数不能为空', {
				icon : 5,
				time : 2000,
				shade : [ 0.5, '#999999' ]
			});
		return;
	}
	if(null == $("#twoMonth").val() || "" == $("#twoMonth").val()){
		top.layer.msg('二月签到次数不能为空', {
				icon : 5,
				time : 2000,
				shade : [ 0.5, '#999999' ]
			});
		return;
	}
	if(null == $("#threeMonth").val() || "" == $("#threeMonth").val()){
		top.layer.msg('三月签到次数不能为空', {
				icon : 5,
				time : 2000,
				shade : [ 0.5, '#999999' ]
			});
		return;
	}
	if(null == $("#fourMonth").val() || "" == $("#fourMonth").val()){
		top.layer.msg('四月签到次数不能为空', {
				icon : 5,
				time : 2000,
				shade : [ 0.5, '#999999' ]
			});
		return;
	}
	if(null == $("#fiveMonth").val() || "" == $("#fiveMonth").val()){
		top.layer.msg('五月签到次数不能为空', {
				icon : 5,
				time : 2000,
				shade : [ 0.5, '#999999' ]
			});
		return;
	}
	if(null == $("#sixMonth").val() || "" == $("#sixMonth").val()){
		top.layer.msg('六月签到次数不能为空', {
				icon : 5,
				time : 2000,
				shade : [ 0.5, '#999999' ]
			});
		return;
	}
	if(null == $("#sevenMonth").val() || "" == $("#sevenMonth").val()){
		top.layer.msg('七月签到次数不能为空', {
				icon : 5,
				time : 2000,
				shade : [ 0.5, '#999999' ]
			});
		return;
	}
	if(null == $("#eightMonth").val() || "" == $("#eightMonth").val()){
		top.layer.msg('八月签到次数不能为空', {
				icon : 5,
				time : 2000,
				shade : [ 0.5, '#999999' ]
			});
		return;
	}
	if(null == $("#nineMonth").val() || "" == $("#nineMonth").val()){
		top.layer.msg('九月签到次数不能为空', {
				icon : 5,
				time : 2000,
				shade : [ 0.5, '#999999' ]
			});
		return;
	}
	if(null == $("#tenMonth").val() || "" == $("#tenMonth").val()){
		top.layer.msg('十月签到次数不能为空', {
				icon : 5,
				time : 2000,
				shade : [ 0.5, '#999999' ]
			});
		return;
	}
	if(null == $("#elevenMonth").val() || "" == $("#elevenMonth").val()){
		top.layer.msg('十一月签到次数不能为空', {
				icon : 5,
				time : 2000,
				shade : [ 0.5, '#999999' ]
			});
		return;
	}
	if(null == $("#twelveMonth").val() || "" == $("#twelveMonth").val()){
		top.layer.msg('十二月签到次数不能为空', {
				icon : 5,
				time : 2000,
				shade : [ 0.5, '#999999' ]
			});
		return;
	}
	doSave();
}

function doSave(){
	var msgIndex = top.layer.msg('数据保存中', {icon:16, shade:[ 0.5, '#999999' ], time:0});
	$.ajax({
      	type: 'POST',
      	url: basePath + '/shgl/signIn/doSaveMonth.do?id'+$("#ctsId").val(),
      	data: $("#addForm").serialize(),
      	success: function(data){
      		top.layer.close(msgIndex);
      		if(data == 'success'){
      			top.layer.msg('数据保存成功', {
  					icon : 6,
  					time : 2000,
  					shade : [ 0.5, '#999999' ]
  				},function() {
  					top.layer.close(top.layer.getFrameIndex(window.name));
					});
      		}else{
      			top.layer.msg('数据保存失败，请联系管理员', {shade : [ 0.5, '#999999' ]});
      		}
      	},
      	error: function(data){
      		top.layer.close(msgIndex);
      		top.layer.msg('程序出错，请联系管理员', {shade : [ 0.5, '#999999' ]});
      	}
      });
}

//取消按钮事件
$("#cancleBtn").click(function(){
	var index = parent.layer.getFrameIndex(window.name);
    parent.layer.close(index);
});